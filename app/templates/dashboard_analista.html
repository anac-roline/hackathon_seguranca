{% extends "base.html" %} 
{% block title %}Painel de Análise{% endblock %} 
{% block content %}

<div class="dashboard-header">
  <div class="dashboard-welcome">
    <h1>Painel de Análise de Ocorrências</h1>
    <p>Bem-vindo, Analista <span>{{ request.cookies.get('username') }}</span>.</p>
  </div>
  </div>

<div class="stats-row">
  <div class="stat-card">
    <i class="fas fa-globe-americas stat-icon"></i>
    <div class="stat-value">{{ total_issues }}</div>
    <div class="stat-label">Total de Ocorrências</div>
  </div>
  <div class="stat-card">
    <i class="fas fa-exclamation-triangle stat-icon"></i>
    <div class="stat-value">{{ stats.abertas_hoje }}</div>
    <div class="stat-label">Abertas Hoje</div>
  </div>
</div>

<div class="dashboard-card map-card">
  <div class="card-header">
    <h2><i class="fas fa-map-marked-alt"></i> Mapa de Análise de Desordens</h2>
    </div>
  <div id="analystMap" class="issues-map-container" style="height: 600px;"></div>
</div>

<div class="dashboard-grid">
  <div class="dashboard-card">
    <div class="card-header">
      <h2>Ocorrências por Categoria</h2>
    </div>
    </div>
  <div class="dashboard-card">
    <div class="card-header">
      <h2>Últimas Ocorrências Registradas no Sistema</h2>
    </div>
    </div>
</div>

<script>
  // Exemplo usando a variável 'map_data' passada pelo backend
  const allIssuesData = {{ map_data|tojson|safe }};
  // Lógica para inicializar o mapa do analista (Leaflet com Heatmap, Plotly, etc.)
  // ...
</script>

{% endblock %}